offset of each atoms in protmat:
atom 1 off 1 norb 3
atom 2 off 4 norb 3
atom 3 off 7 norb 3
atom 4 off 10 norb 3

============================================symm i= 1
rot(Bravis)
[[1 0 0]
 [0 1 0]
 [0 0 1]]
rot_glb before forecing symm =
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
rot_glb after  forecing symm =
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= 1.0
euler angles pi [0. 0. 0.]
error of rot_glb and that by euler2rmat
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
euler2rmat sum abs error: 0.0
dmat before forcing symm = 
[[1.+0.j 0.-0.j]
 [0.+0.j 1.+0.j]]
dmat after  forcing symm = 
[[1.+0.j 0.+0.j]
 [0.+0.j 1.+0.j]]
diffs
[[0.+0.j 0.+0.j]
 [0.+0.j 0.+0.j]]
gtrans
[-0. -0. -0.]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 1
2 -> 2
3 -> 3
4 -> 4
--------------------------------
jatom->iatom 1 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.055692777  0.5          0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 1 iptr 1 jatom 1 vec_shift             [0. 0. 0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
--------------------------------
jatom->iatom 2 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.9998172    0.5          0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 1 iptr 1 jatom 2 vec_shift             [0. 0. 0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
--------------------------------
jatom->iatom 3 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.555692784  0.           0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 1 iptr 1 jatom 3 vec_shift             [0. 0. 0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
--------------------------------
jatom->iatom 4 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.49981723   0.           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 1 iptr 1 jatom 4 vec_shift             [0. 0. 0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 2
rot(Bravis)
[[-1  0  0]
 [ 0 -1  0]
 [ 0  0 -1]]
rot_glb before forecing symm =
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
rot_glb after  forecing symm =
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= -1.0
euler angles pi [0. 0. 0.]
error of rot_glb and that by euler2rmat
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
euler2rmat sum abs error: 0.0
dmat before forcing symm = 
[[1.+0.j 0.-0.j]
 [0.+0.j 1.+0.j]]
dmat after  forcing symm = 
[[1.+0.j 0.+0.j]
 [0.+0.j 1.+0.j]]
diffs
[[0.+0.j 0.+0.j]
 [0.+0.j 0.+0.j]]
gtrans
[ 0.055509977  -0.            0.9724731601]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 2
2 -> 1
3 -> 4
4 -> 3
--------------------------------
jatom->iatom 1 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-1.8280001148e-04 -5.0000000000e-01  4.1197117974e-01]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 2 iptr 1 jatom 1 vec_shift             [-1. -1.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 2 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.944307223  -0.5           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 2 iptr 1 jatom 2 vec_shift             [-1. -1.  0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 3 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.500182807   0.            0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 2 iptr 1 jatom 3 vec_shift             [-1.  0.  0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 4 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.444307253   0.            0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 2 iptr 1 jatom 4 vec_shift             [-1.  0.  0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 3
rot(Bravis)
[[ 1  0  0]
 [ 0 -1  0]
 [ 0  0 -1]]
rot_glb before forecing symm =
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
rot_glb after  forecing symm =
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= 1.0
euler angles pi [1. 1. 0.]
error of rot_glb and that by euler2rmat
[[ 0.0000000000e+00  1.2246467991e-16  1.2246467991e-16]
 [ 1.2246467991e-16  0.0000000000e+00 -1.4997597827e-32]
 [ 1.2246467991e-16  0.0000000000e+00  0.0000000000e+00]]
euler2rmat sum abs error: 4.898587196589413e-16
dmat before forcing symm = 
[[ 3.7493994567e-33-6.1232339957e-17j -6.1232339957e-17+1.0000000000e+00j]
 [ 6.1232339957e-17+1.0000000000e+00j  3.7493994567e-33+6.1232339957e-17j]]
dmat after  forcing symm = 
[[ 0.0000000000e+00+0.j -6.1232339957e-17+1.j]
 [ 6.1232339957e-17+1.j  0.0000000000e+00+0.j]]
diffs
[[3.7493994567e-33-6.1232339957e-17j 0.0000000000e+00+0.0000000000e+00j]
 [0.0000000000e+00+0.0000000000e+00j 3.7493994567e-33+6.1232339957e-17j]]
gtrans
[0.5          0.5          0.9724731601]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 3
2 -> 4
3 -> 1
4 -> 2
--------------------------------
jatom->iatom 1 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.555692777  0.           0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 3 iptr 1 jatom 1 vec_shift             [-0.  0.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 2 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [1.4998172    0.           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 3 iptr 1 jatom 2 vec_shift             [1. 0. 0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 3 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [1.055692784  0.5          0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 3 iptr 1 jatom 3 vec_shift             [1. 0. 0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 4 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.99981723   0.5          0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 3 iptr 1 jatom 4 vec_shift             [0. 0. 0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 4
rot(Bravis)
[[-1  0  0]
 [ 0  1  0]
 [ 0  0  1]]
rot_glb before forecing symm =
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
rot_glb after  forecing symm =
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= -1.0
euler angles pi [1. 1. 0.]
error of rot_glb and that by euler2rmat
[[ 0.0000000000e+00 -1.2246467991e-16 -1.2246467991e-16]
 [-1.2246467991e-16  0.0000000000e+00  1.4997597827e-32]
 [-1.2246467991e-16  0.0000000000e+00  0.0000000000e+00]]
euler2rmat sum abs error: 4.898587196589413e-16
dmat before forcing symm = 
[[ 3.7493994567e-33-6.1232339957e-17j -6.1232339957e-17+1.0000000000e+00j]
 [ 6.1232339957e-17+1.0000000000e+00j  3.7493994567e-33+6.1232339957e-17j]]
dmat after  forcing symm = 
[[ 0.0000000000e+00+0.j -6.1232339957e-17+1.j]
 [ 6.1232339957e-17+1.j  0.0000000000e+00+0.j]]
diffs
[[3.7493994567e-33-6.1232339957e-17j 0.0000000000e+00+0.0000000000e+00j]
 [0.0000000000e+00+0.0000000000e+00j 3.7493994567e-33+6.1232339957e-17j]]
gtrans
[ 0.555509977  0.5         -0.         ]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 4
2 -> 3
3 -> 2
4 -> 1
--------------------------------
jatom->iatom 1 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.4998172    1.           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 4 iptr 1 jatom 1 vec_shift             [-0.  1.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 2 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.444307223   1.            0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 4 iptr 1 jatom 2 vec_shift             [-1.  1.  0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 3 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-1.8280701149e-04  5.0000000000e-01  4.1197117974e-01]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 4 iptr 1 jatom 3 vec_shift             [-1.  0.  0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 4 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.055692747  0.5          0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 4 iptr 1 jatom 4 vec_shift             [-0.  0.  0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 5
rot(Bravis)
[[-1  0  0]
 [ 0  1  0]
 [ 0  0 -1]]
rot_glb before forecing symm =
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
rot_glb after  forecing symm =
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= 1.0
euler angles pi [0. 1. 0.]
error of rot_glb and that by euler2rmat
[[ 0.0000000000e+00  0.0000000000e+00 -1.2246467991e-16]
 [ 0.0000000000e+00  0.0000000000e+00  0.0000000000e+00]
 [ 1.2246467991e-16  0.0000000000e+00  0.0000000000e+00]]
euler2rmat sum abs error: 2.4492935982947064e-16
dmat before forcing symm = 
[[ 6.1232339957e-17+0.j -1.0000000000e+00-0.j]
 [ 1.0000000000e+00+0.j  6.1232339957e-17+0.j]]
dmat after  forcing symm = 
[[ 0.+0.j -1.-0.j]
 [ 1.+0.j  0.+0.j]]
diffs
[[6.1232339957e-17+0.j 0.0000000000e+00+0.j]
 [0.0000000000e+00+0.j 6.1232339957e-17+0.j]]
gtrans
[ 0.055509977  -0.            0.9724731601]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 2
2 -> 1
3 -> 4
4 -> 3
--------------------------------
jatom->iatom 1 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-1.8280001148e-04  5.0000000000e-01  4.1197117974e-01]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 5 iptr 1 jatom 1 vec_shift             [-1.  0.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 2 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.944307223   0.5           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 5 iptr 1 jatom 2 vec_shift             [-1.  0.  0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 3 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.500182807   0.            0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 5 iptr 1 jatom 3 vec_shift             [-1.  0.  0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 4 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.444307253   0.            0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 5 iptr 1 jatom 4 vec_shift             [-1.  0.  0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 6
rot(Bravis)
[[ 1  0  0]
 [ 0 -1  0]
 [ 0  0  1]]
rot_glb before forecing symm =
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
rot_glb after  forecing symm =
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= -1.0
euler angles pi [0. 1. 0.]
error of rot_glb and that by euler2rmat
[[ 0.0000000000e+00  0.0000000000e+00  1.2246467991e-16]
 [ 0.0000000000e+00  0.0000000000e+00  0.0000000000e+00]
 [-1.2246467991e-16  0.0000000000e+00  0.0000000000e+00]]
euler2rmat sum abs error: 2.4492935982947064e-16
dmat before forcing symm = 
[[ 6.1232339957e-17+0.j -1.0000000000e+00-0.j]
 [ 1.0000000000e+00+0.j  6.1232339957e-17+0.j]]
dmat after  forcing symm = 
[[ 0.+0.j -1.-0.j]
 [ 1.+0.j  0.+0.j]]
diffs
[[6.1232339957e-17+0.j 0.0000000000e+00+0.j]
 [0.0000000000e+00+0.j 6.1232339957e-17+0.j]]
gtrans
[-0. -0. -0.]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 1
2 -> 2
3 -> 3
4 -> 4
--------------------------------
jatom->iatom 1 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [ 0.055692777  -0.5           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 6 iptr 1 jatom 1 vec_shift             [ 0. -1.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 2 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [ 0.9998172    -0.5           0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 6 iptr 1 jatom 2 vec_shift             [ 0. -1.  0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 3 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.555692784  0.           0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 6 iptr 1 jatom 3 vec_shift             [0. 0. 0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 4 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.49981723   0.           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 6 iptr 1 jatom 4 vec_shift             [0. 0. 0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 7
rot(Bravis)
[[-1  0  0]
 [ 0 -1  0]
 [ 0  0  1]]
rot_glb before forecing symm =
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
rot_glb after  forecing symm =
[[-1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0.  1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= 1.0
euler angles pi [1. 0. 0.]
error of rot_glb and that by euler2rmat
[[ 0.0000000000e+00  1.2246467991e-16  0.0000000000e+00]
 [-1.2246467991e-16  0.0000000000e+00  0.0000000000e+00]
 [ 0.0000000000e+00  0.0000000000e+00  0.0000000000e+00]]
euler2rmat sum abs error: 2.4492935982947064e-16
dmat before forcing symm = 
[[ 6.1232339957e-17-1.j -0.0000000000e+00+0.j]
 [ 0.0000000000e+00+0.j  6.1232339957e-17+1.j]]
dmat after  forcing symm = 
[[6.1232339957e-17-1.j 0.0000000000e+00+0.j]
 [0.0000000000e+00+0.j 6.1232339957e-17+1.j]]
diffs
[[ 0.+0.j -0.+0.j]
 [ 0.+0.j  0.+0.j]]
gtrans
[ 0.555509977  0.5         -0.         ]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 4
2 -> 3
3 -> 2
4 -> 1
--------------------------------
jatom->iatom 1 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.4998172    0.           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 7 iptr 1 jatom 1 vec_shift             [-0.  0.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 2 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-0.444307223   0.            0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 7 iptr 1 jatom 2 vec_shift             [-1.  0.  0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 3 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [-1.8280701149e-04  5.0000000000e-01  4.1197117974e-01]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 7 iptr 1 jatom 3 vec_shift             [-1.  0.  0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
--------------------------------
jatom->iatom 4 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.055692747  0.5          0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 7 iptr 1 jatom 4 vec_shift             [-0.  0.  0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[ 1.  0.  0.]
 [ 0. -1.  0.]
 [ 0.  0. -1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
============================================symm i= 8
rot(Bravis)
[[ 1  0  0]
 [ 0  1  0]
 [ 0  0 -1]]
rot_glb before forecing symm =
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
rot_glb after  forecing symm =
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0. -1.]]
diffs
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
det of rot_glb= -1.0
euler angles pi [1. 0. 0.]
error of rot_glb and that by euler2rmat
[[ 0.0000000000e+00 -1.2246467991e-16  0.0000000000e+00]
 [ 1.2246467991e-16  0.0000000000e+00  0.0000000000e+00]
 [ 0.0000000000e+00  0.0000000000e+00  0.0000000000e+00]]
euler2rmat sum abs error: 2.4492935982947064e-16
dmat before forcing symm = 
[[ 6.1232339957e-17-1.j -0.0000000000e+00+0.j]
 [ 0.0000000000e+00+0.j  6.1232339957e-17+1.j]]
dmat after  forcing symm = 
[[6.1232339957e-17-1.j 0.0000000000e+00+0.j]
 [0.0000000000e+00+0.j 6.1232339957e-17+1.j]]
diffs
[[ 0.+0.j -0.+0.j]
 [ 0.+0.j  0.+0.j]]
gtrans
[0.5          0.5          0.9724731601]
ptrans 1 
[0. 0. 0.]
wann atom rotmap=
1 -> 3
2 -> 4
3 -> 1
4 -> 2
--------------------------------
jatom->iatom 1 3
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.055692777  0.5          0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.555692777  1.           0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.555692784  0.           0.4119711797]
isymm 8 iptr 1 jatom 1 vec_shift             [-0.  1.  0.]
jatom 1 orbital p offj 1 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 2 4
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.9998172    0.5          0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [1.4998172    1.           0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.49981723   0.           0.5605019804]
isymm 8 iptr 1 jatom 2 vec_shift             [1. 1. 0.]
jatom 2 orbital p offj 4 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 3 1
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.555692784  0.           0.4119711797]
new_vec = dot(rot,old_vec) + gtrans + ptrans [1.055692784  0.5          0.5605019804]
          atoms_frac[:,atom_num[iatom]-1]    [0.055692777  0.5          0.5605019804]
isymm 8 iptr 1 jatom 3 vec_shift             [1. 0. 0.]
jatom 3 orbital p offj 7 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
--------------------------------
jatom->iatom 4 2
old_vec = atoms_frac[:,atom_num[jatom]-1]    [0.49981723   0.           0.5605019804]
new_vec = dot(rot,old_vec) + gtrans + ptrans [0.99981723   0.5          0.4119711797]
          atoms_frac[:,atom_num[iatom]-1]    [0.9998172    0.5          0.4119711797]
isymm 8 iptr 1 jatom 4 vec_shift             [0. 0. 0.]
jatom 4 orbital p offj 10 norb 3 -------
protrotmat_orb
[[-1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]
+++++++++++++++++++++++++++++++++++++++++++++++++
